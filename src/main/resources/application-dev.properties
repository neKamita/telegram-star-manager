# =================================================================
# TELEGRAM STAR MANAGER - LOCAL DEVELOPMENT CONFIGURATION
# =================================================================
# Этот файл содержит настройки для локальной разработки и тестирования
# Используйте этот профиль для тестирования админки и бота в IntelliJ IDEA

# =================================================================
# SPRING PROFILES
# =================================================================
# ВАЖНО: spring.profiles.active НЕ должен быть в профильном файле!
# Профиль активируется через Run Configuration или переменные окружения
spring.main.lazy-initialization=false
spring.main.allow-circular-references=true

# =================================================================
# TELEGRAM BOT CONFIGURATION - LOCAL POLLING MODE
# =================================================================
# ВАЖНО: Замените YOUR_BOT_TOKEN_HERE на реальный токен вашего бота
telegram.bot.token=${TELEGRAM_BOT_TOKEN:YOUR_BOT_TOKEN_HERE}
telegram.bot.username=${TELEGRAM_BOT_USERNAME:MirzaShop_bot}

# Bot timeout settings for local development
telegram.bot.connection-timeout=30
telegram.bot.read-timeout=60

# =================================================================
# SERVER CONFIGURATION
# =================================================================
server.port=8080
server.servlet.context-path=/
server.compression.enabled=false

# =================================================================
# NEONDB POSTGRESQL CONFIGURATION FOR DEVELOPMENT
# =================================================================
# Используем отдельную dev базу в NeonDB для безопасного тестирования
# ВАЖНО: Настройте переменные окружения в IntelliJ Run Configuration!

# PostgreSQL Connection с fallback к production переменным
spring.datasource.url=jdbc:postgresql://${DEV_DATABASE_HOST:${DATABASE_HOST}}:${DEV_DATABASE_PORT:${DATABASE_PORT:5432}}/${DEV_DATABASE_NAME:${DATABASE_NAME}}?sslmode=require&prepareThreshold=0
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.username=${DEV_DATABASE_USERNAME:${DATABASE_USERNAME}}
spring.datasource.password=${DEV_DATABASE_PASSWORD:${DATABASE_PASSWORD}}

# =================================================================
# JPA/HIBERNATE CONFIGURATION FOR POSTGRESQL
# =================================================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.open-in-view=false   

# PostgreSQL Specific Settings
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.id.new_generator_mappings=true

# H2 Console отключена для PostgreSQL
spring.h2.console.enabled=false

# =================================================================
# LOGGING CONFIGURATION - ПОДРОБНЫЕ ЛОГИ ДЛЯ ОТЛАДКИ
# =================================================================
logging.level.shit.back=DEBUG
logging.level.org.telegram=INFO
logging.level.org.springframework.web=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.root=INFO

# Console logging pattern for development
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# =================================================================
# SECURITY CONFIGURATION - УПРОЩЕННАЯ ДЛЯ РАЗРАБОТКИ
# =================================================================
security.api.enabled=true
security.api.key=${API_SECRET_KEY:dev-secret-key-12345}
security.api.header-name=X-API-KEY

# Снижен лимит для тестирования
security.rate-limit.enabled=true
security.rate-limit.user-requests-per-minute=50
security.rate-limit.api-requests-per-minute=200

security.validation.enabled=true
security.validation.max-message-length=4096
security.validation.max-callback-data-length=64

security.audit.enabled=true
security.audit.log-level=DEBUG
security.audit.log-sensitive-data=true

# CORS для локальной разработки
security.cors.enabled=true
security.cors.allowed-origins=http://localhost:3000,http://localhost:8080
security.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
security.cors.allowed-headers=*
security.cors.max-age=3600


# =================================================================
# CACHE CONFIGURATION - ПРОСТОЙ КЭШИРОВАНИЕ ДЛЯ РАЗРАБОТКИ
# =================================================================
spring.cache.type=simple
spring.cache.cache-names=admin_performance,admin_recent_activity,admin_dashboard_cache
spring.cache.caffeine.spec=maximumSize=50,expireAfterWrite=5m

# =================================================================
# ASYNC CONFIGURATION
# =================================================================
spring.task.execution.pool.core-size=2
spring.task.execution.pool.max-size=4
spring.task.execution.pool.queue-capacity=25
spring.task.execution.thread-name-prefix=dev-async-
spring.task.scheduling.pool.size=2

# =================================================================
# MANAGEMENT/ACTUATOR ENDPOINTS
# =================================================================
management.endpoints.web.exposure.include=health,info,metrics,env,configprops
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
management.endpoints.web.base-path=/actuator

# =================================================================
# REDIS CONFIGURATION - ОТКЛЮЧЕН ДЛЯ ЛОКАЛЬНОЙ РАЗРАБОТКИ
# =================================================================
# Redis не требуется для локального тестирования
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.timeout=2000ms

# =================================================================
# BOT SELF-TEST CONFIGURATION
# =================================================================
telegram.self-test.enabled=true
telegram.self-test.delay-seconds=30

# =================================================================
# ADMIN DASHBOARD CONFIGURATION
# =================================================================
admin.cache.max-size=20
admin.cache.ttl-minutes=5
admin.async.disabled=false

# =================================================================
# JSON CONFIGURATION
# =================================================================
spring.jackson.property-naming-strategy=SNAKE_CASE
spring.jackson.default-property-inclusion=NON_NULL

# =================================================================
# DEV TOOLS (Если используете Spring Boot DevTools)
# =================================================================
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true
