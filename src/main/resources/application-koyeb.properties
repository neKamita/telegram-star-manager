# Koyeb-specific optimizations for 512MB RAM and 0.1 vCPU
# This profile is automatically activated when ENVIRONMENT=production

# Spring profile configuration
spring.profiles.active=production,postgresql

# Server configuration
server.port=8080
server.servlet.context-path=/
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# HTTPS configuration for Koyeb
server.forward-headers-strategy=framework
server.use-forward-headers=true

# Tomcat optimization for limited resources
server.tomcat.max-threads=15
server.tomcat.min-spare-threads=3
server.tomcat.accept-count=10
server.tomcat.max-connections=50
server.tomcat.connection-timeout=20000

# JPA/Hibernate optimization (if database is used)
spring.jpa.show-sql=false
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Connection pool optimization for Redis (if used) - Ultra-low resource usage
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=2
spring.data.redis.lettuce.pool.max-idle=1
spring.data.redis.lettuce.pool.min-idle=0
spring.data.redis.lettuce.pool.max-wait=1000ms
spring.data.redis.lettuce.shutdown-timeout=100ms

# Logging optimization - reduce verbosity
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.com.zaxxer.hikari=WARN
logging.level.org.telegram=INFO
logging.level.shit.back=INFO
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# Application-specific optimizations
management.endpoints.enabled-by-default=false
management.endpoint.health.enabled=true
management.endpoint.info.enabled=true
management.endpoints.web.base-path=/actuator

# Security optimizations
security.rate-limit.user-requests-per-minute=20
security.rate-limit.api-requests-per-minute=60

# Telegram bot optimizations
telegram.bot.connection-timeout=30
telegram.bot.read-timeout=60
telegram.bot.webhook-timeout=30

# Telegram bot webhook configuration for production
telegram.bot.webhook-url=${TELEGRAM_BOT_WEBHOOK_URL:https://brave-selina-g45-16b60ff3.koyeb.app}
telegram.bot.token=${TELEGRAM_BOT_TOKEN}
telegram.bot.username=${TELEGRAM_BOT_USERNAME}

# Memory optimization
spring.jmx.enabled=false
spring.main.lazy-initialization=true

# Bot Self-Test configuration - Reduced frequency for resource optimization
telegram.self-test.enabled=true
telegram.self-test.delay-seconds=60
